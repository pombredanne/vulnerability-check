from importer.import_cve_db import NDVDATAImporter
from importer.import_mitre_cve import MITREDataImporter
from importer.import_rhsa_db import RHSADataImporter
from importer.import_alsa_db import ALASDataImporter
from importer.import_dla_db import DLADataImporter
from importer.import_dsa_db import DSADataImporter
from vul_check import CVEProcessor


def import_db(database_file):
    # 1. Import NVD CVE
    nvd_importer = NDVDATAImporter(database_file)
    nvd_importer.main()
    print("NVD CVE database was imported!")

    # 2. Import MITRE CVE
    mitre_importer = MITREDataImporter(database_file)
    mitre_importer.main()
    print("MITRE CVE database was imported!")

    # 3. Import RHSA
    rhsa_importer = RHSADataImporter(database_file)
    rhsa_importer.main()
    print("RHSA database was imported!")

    # 4. Import ALAS
    alas_importer = ALASDataImporter(database_file)
    alas_importer.main()
    print("ALAS database was imported!")

    # 5. Import DLA
    dla_importer = DLADataImporter(database_file)
    dla_importer.main()
    print("DLA database was imported!")

    # 5. Import DLA
    dsa_importer = DSADataImporter(database_file)
    dsa_importer.main()
    print("DSA database was imported!")
    
def check_cve_detail(database_file, input_file, output_file):
    vulnerability_check = CVEProcessor(database_file,input_file, output_file)
    vulnerability_check.main()

def main():
    # Example usage:
    input_file = "list_cve.csv"
    output_file = "output_detail.csv"
    database_file = "cve_data.db"
    #import_db(database_file)
    check_cve_detail(database_file, input_file, output_file)

if __name__ == "__main__":
    main()